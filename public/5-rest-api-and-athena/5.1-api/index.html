<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.9">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Create and Implement API :: </title>

    
    <link href="/css/nucleus.css?1753551701" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1753551701" rel="stylesheet">
    <link href="/css/hybrid.css?1753551701" rel="stylesheet">
    <link href="/css/featherlight.min.css?1753551701" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1753551701" rel="stylesheet">
    <link href="/css/auto-complete.css?1753551701" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1753551701" rel="stylesheet">
    <link href="/css/theme.css?1753551701" rel="stylesheet">
    <link href="/css/hugo-theme.css?1753551701" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1753551701" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1753551701"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/5-rest-api-and-athena/5.1-api/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1753551701"></script>
<script type="text/javascript" src="/js/auto-complete.js?1753551701"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/localhost:1313\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1753551701"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-create-new-aws-account/" title="Setting Up the template for the Workshop" class="dd-item 
        
        
        
        ">
      <a href="/1-create-new-aws-account/">
           <b> 1. </b> Setting Up the template for the Workshop
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/1-create-new-aws-account/1.1-find-account-id/" title="Setting Up Vite" class="dd-item 
        
        
        
        ">
      <a href="/1-create-new-aws-account/1.1-find-account-id/">
           <b> 1.1 </b> Setting Up Vite
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-create-new-aws-account/1.2-update-account/" title="Initialize Git and Push Project to GitHub" class="dd-item 
        
        
        
        ">
      <a href="/1-create-new-aws-account/1.2-update-account/">
           <b> 1.2 </b> Initialize Git and Push Project to GitHub
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-create-new-aws-account/1.3-aws-account-alias/" title="Setting Up Amplify For The Project" class="dd-item 
        
        
        
        ">
      <a href="/1-create-new-aws-account/1.3-aws-account-alias/">
           <b> 1.3 </b> Setting Up Amplify For The Project
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-mfa-setup-for-aws-user-root/" title="Working on the main Functionality of the project using AWS Services" class="dd-item 
        
        
        
        ">
      <a href="/2-mfa-setup-for-aws-user-root/">
           <b> 2. </b> Working on the main Functionality of the project using AWS Services
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-mfa-setup-for-aws-user-root/1-virtual-mfa-device/" title="Setting Up the IAM Identity Center" class="dd-item 
        
        
        
        ">
      <a href="/2-mfa-setup-for-aws-user-root/1-virtual-mfa-device/">
           <b> 2.1 </b> Setting Up the IAM Identity Center
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-mfa-setup-for-aws-user-root/2-u2f-security-key/" title="Deploy the Application via AWS Amplify" class="dd-item 
        
        
        
        ">
      <a href="/2-mfa-setup-for-aws-user-root/2-u2f-security-key/">
           <b> 2.2 </b> Deploy the Application via AWS Amplify
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-mfa-setup-for-aws-user-root/3-other-hardware-mfa-device/" title="Setting up the Frontend, Backend and AWS Sandbox" class="dd-item 
        
        
        
        ">
      <a href="/2-mfa-setup-for-aws-user-root/3-other-hardware-mfa-device/">
           <b> 2.3 </b> Setting up the Frontend, Backend and AWS Sandbox
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-create-admin-user-and-group/" title="Creating and Developing Amazon Bedrock and CloudWatch" class="dd-item 
        
        
        
        ">
      <a href="/3-create-admin-user-and-group/">
           <b> 3. </b> Creating and Developing Amazon Bedrock and CloudWatch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-create-admin-user-and-group/3.1-legacy-way/" title="Setting up AWS Bedrock (Legacy)" class="dd-item 
        
        
        
        ">
      <a href="/3-create-admin-user-and-group/3.1-legacy-way/">
           <b> 3.1 </b> Setting up AWS Bedrock (Legacy)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-admin-user-and-group/3.2-cross-region/" title="Setting up AWS Bedrock (Cross-Region)" class="dd-item 
        
        
        
        ">
      <a href="/3-create-admin-user-and-group/3.2-cross-region/">
           <b> 3.2 </b> Setting up AWS Bedrock (Cross-Region)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-create-admin-user-and-group/3.3-cloudwatch/" title="Apply CloudWatch to monitor average response time" class="dd-item 
        
        
        
        ">
      <a href="/3-create-admin-user-and-group/3.3-cloudwatch/">
           <b> 3.3 </b> Apply CloudWatch to monitor average response time
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-verify-new-account/" title="Build the website frontend, S3 and Lambda" class="dd-item 
        
        
        
        ">
      <a href="/4-verify-new-account/">
           <b> 4. </b> Build the website frontend, S3 and Lambda
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4-verify-new-account/4.1-frontend/" title="Build The Website Frontend" class="dd-item 
        
        
        
        ">
      <a href="/4-verify-new-account/4.1-frontend/">
           <b> 4.1 </b> Build The Website Frontend
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-verify-new-account/4.2-s3/" title="Build the S3 Bucket for data storage" class="dd-item 
        
        
        
        ">
      <a href="/4-verify-new-account/4.2-s3/">
           <b> 4.2 </b> Build the S3 Bucket for data storage
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-verify-new-account/4.3-lambda/" title="Build the Lambda" class="dd-item 
        
        
        
        ">
      <a href="/4-verify-new-account/4.3-lambda/">
           <b> 4.3 </b> Build the Lambda
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-rest-api-and-athena/" title="Update API and Athena" class="dd-item 
        parent
        
        
        ">
      <a href="/5-rest-api-and-athena/">
           <b> 5. </b> Update API and Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/5-rest-api-and-athena/5.1-api/" title="Create and Implement API" class="dd-item 
        
        active
        
        ">
      <a href="/5-rest-api-and-athena/5.1-api/">
           <b> 5.1 </b> Create and Implement API
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5-rest-api-and-athena/5.2-athena/" title="Set up Athena for analysis" class="dd-item 
        
        
        
        ">
      <a href="/5-rest-api-and-athena/5.2-athena/">
           <b> 5.2 </b> Set up Athena for analysis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/12-s3-bucket-for-data-storage/" title="Creating S3 Bucket for Data Storage" class="dd-item 
        
        
        
        ">
      <a href="/12-s3-bucket-for-data-storage/">
           <b> 12. </b> Creating S3 Bucket for Data Storage
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/12-s3-bucket-for-data-storage/12.1-navigate-to-s3-console/" title="Navigate to S3 Console" class="dd-item 
        
        
        
        ">
      <a href="/12-s3-bucket-for-data-storage/12.1-navigate-to-s3-console/">
           <b> 12.1 </b> Navigate to S3 Console
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/12-s3-bucket-for-data-storage/12.2-configure-bucket-settings/" title="Configure Bucket Settings" class="dd-item 
        
        
        
        ">
      <a href="/12-s3-bucket-for-data-storage/12.2-configure-bucket-settings/">
           <b> 12.2 </b> Configure Bucket Settings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/12-s3-bucket-for-data-storage/12.3-create-the-bucket/" title="Create the Bucket" class="dd-item 
        
        
        
        ">
      <a href="/12-s3-bucket-for-data-storage/12.3-create-the-bucket/">
           <b> 12.3 </b> Create the Bucket
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/blogs"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830891&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>26-11-2023</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Setting up an AWS account</a> > <a href='/5-rest-api-and-athena/'>Update API and Athena</a> > Create and Implement API
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#content">Content</a></li>
    <li><a href="#create-a-rest-api-with-api-gateway">Create a REST API with API Gateway</a></li>
    <li><a href="#update-projects-codebase-to-work-with-new-changes">Update project’s codebase to work with new changes</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Create and Implement API
            </h1>
          

        



	<h2 id="content">Content</h2>
<ul>
<li><a href="#create-a-rest-api-with-api-gateway">Create a REST API with API Gateway</a></li>
<li><a href="#update-projects-codebase-to-work-with-new-changes">Update project’s codebase to work with new changes</a></li>
</ul>
<h2 id="create-a-rest-api-with-api-gateway">Create a REST API with API Gateway</h2>
<p>Go to API Gateway console → Create API → REST API → Build</p>
<p><img src="/images/5/16-1.png?featherlight=false&amp;width=90pc" alt="Logo"></p>
<p>•	API name: leftover-data-collection-api
•	Endpoint type: Regional</p>
<p><img src="/images/5/16-2.png?featherlight=false&amp;width=90pc" alt="Logo"></p>
<p>On the left handside, click Create resource and fill in these info:
•	Create resource: /collect-data
•	CORS: Enable</p>
<p><img src="/images/5/16-3.png?featherlight=false&amp;width=90pc" alt="Logo"></p>
<p>Then on the right handside, click Create method with these settings:
•	Create method: POST
•	Integration type: Lambda Function
•	Lambda function: leftover-data-collector
•	Use Lambda Proxy integration: Yes</p>
<p><img src="/images/5/16-4.png?featherlight=false&amp;width=90pc" alt="Logo"></p>
<p>Click on the resource directory we just made to enable CORS by following these steps:
•	Select the POST method
•	Actions → Enable CORS
•	Access-Control-Allow-Origin: *
•	Access-Control-Allow-Headers: Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token</p>
<p><img src="/images/5/16-5.png?featherlight=false&amp;width=90pc" alt="Logo">
<img src="/images/5/16-6.png?featherlight=false&amp;width=90pc" alt="Logo"></p>
<p>Then click Deploy API with stage name of your choice:</p>
<h2 id="update-projects-codebase-to-work-with-new-changes">Update project’s codebase to work with new changes</h2>
<p>In App.tsx, incorporate these new lines of code to the existing one:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#75715e">// ... existing imports ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">getCurrentUser</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;aws-amplify/auth&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ... existing code ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App() {</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// ... existing state variables ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Add this new function for data collection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">collectUserData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">ingredients</span>: <span style="color:#66d9ef">string</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">getCurrentUser</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sessionId</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`session_</span><span style="color:#e6db74">${</span>Date.<span style="color:#a6e22e">now</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>Math.<span style="color:#a6e22e">random</span>().<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">36</span>).<span style="color:#a6e22e">substr</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dataPayload</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ingredients</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">timestamp</span>: <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">userId</span>: <span style="color:#66d9ef">user.userId</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;anonymous&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sessionId</span>
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Replace YOUR_API_GATEWAY_URL with the actual URL from step 15
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;YOUR_API_GATEWAY_URL/collect-data&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">body</span>: <span style="color:#66d9ef">JSON.stringify</span>(<span style="color:#a6e22e">dataPayload</span>)
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Silently fail - don&#39;t disrupt user experience
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Data collection failed:&#39;</span>, <span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">onSubmit</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">event</span>: <span style="color:#66d9ef">FormEvent</span>&lt;<span style="color:#f92672">HTMLFormElement</span>&gt;) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">preventDefault</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">inputValue</span>.<span style="color:#a6e22e">trim</span>()) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setLoading</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setResult</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setError</span>(<span style="color:#66d9ef">null</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setUsingFallback</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ingredientsInput</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">inputValue</span>.<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Collect user data (fire and forget)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">collectUserData</span>(<span style="color:#a6e22e">ingredientsInput</span>);
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ingredientsArray</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ingredientsInput</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;,&#34;</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">ingredient</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">ingredient</span>.<span style="color:#a6e22e">trim</span>())
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">ingredient</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">ingredient</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// ... rest of existing onSubmit logic remains the same ...
</span></span></span></code></pre></div><p>I have commented all necessary information on what each part of the code should do. However, it will now run out of the box, you should replace the API Gateway URL yourself. You can expect to find it in the ARN box in POST method.</p>
<p><img src="/images/5/17-1.png?featherlight=false&amp;width=90pc" alt="Logo"></p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/5-rest-api-and-athena/" title="Update API and Athena"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/5-rest-api-and-athena/5.2-athena/" title="Set up Athena for analysis" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1753551701"></script>
    <script src="/js/perfect-scrollbar.min.js?1753551701"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1753551701"></script>
    <script src="/js/jquery.sticky.js?1753551701"></script>
    <script src="/js/featherlight.min.js?1753551701"></script>
    <script src="/js/highlight.pack.js?1753551701"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1753551701"></script>
    <script src="/js/learn.js?1753551701"></script>
    <script src="/js/hugo-learn.js?1753551701"></script>

    <link href="/mermaid/mermaid.css?1753551701" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1753551701"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
